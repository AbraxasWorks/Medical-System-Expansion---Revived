<?xml version="1.0" encoding="utf-8" ?>
<Patch>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationSequence">
			<operations>

        <!-- remove verbs -->
        <li Class="PatchOperationRemove">
          <xpath>/Defs/HediffDef[@ParentName="addedPartBionics"][defName="PowerArm"]/comps/li[@Class="HediffCompProperties_VerbGiver"]</xpath>
        </li>
	
				<!-- power arm -->
        <!-- TODO: add power hand? -->

				<li Class="OrenoMSE.XpathPatches.PatchOperationAddToList">
					<xpath>/Defs/HediffDef[@ParentName="addedPartBionics"][defName="PowerArm"]</xpath>
					<list>comps</list>
					<value>
						<li Class="OrenoMSE.Modules.HediffCompProperties_ModuleHolder">
							<maxModules>1</maxModules>
						</li>
					</value>
				</li>

				<li Class="OrenoMSE.XpathPatches.PatchOperationAddToList">
					<xpath>/Defs/ThingDef[@ParentName="Bionic"][defName="PowerArm"]</xpath>
					<list>comps</list>
					<value>
						<li Class="OrenoMSE.CompProperties_CompIncludedChildParts">
							<standardChildren>
								<li>BionicHand</li>
								<li>PlasteelHumerus</li>
								<li>PlasteelRadius</li>
							</standardChildren>
						</li>
					</value>
				</li>

        <li Class="PatchOperationReplace">
          <xpath>/Defs/RecipeDef[defName="InstallPowerArm"]/appliedOnFixedBodyParts</xpath>
          <value>
            <appliedOnFixedBodyParts>
              <li>Arm</li>    
            </appliedOnFixedBodyParts>
          </value>
        </li>

        <!-- bionic arm -->

				<li Class="OrenoMSE.XpathPatches.PatchOperationAddToList">
					<xpath>/Defs/ThingDef[@ParentName="Bionic"][defName="BionicArm"]</xpath>
					<list>comps</list>
					<value>
						<li Class="OrenoMSE.CompProperties_CompIncludedChildParts">
							<standardChildren>
								<li>BionicHand</li>
								<li>PlasteelHumerus</li>
								<li>PlasteelRadius</li>
							</standardChildren>
						</li>
					</value>
				</li>

        <li Class="PatchOperationReplace">
          <xpath>/Defs/RecipeDef[defName="InstallBionicArm"]/appliedOnFixedBodyParts</xpath>
          <value>
            <appliedOnFixedBodyParts>
              <li>Arm</li>    
            </appliedOnFixedBodyParts>
          </value>
        </li>

        <!-- bionic leg -->

				<li Class="OrenoMSE.XpathPatches.PatchOperationAddToList">
					<xpath>/Defs/ThingDef[@ParentName="Bionic"][defName="BionicLeg"]</xpath>
					<list>comps</list>
					<value>
						<li Class="OrenoMSE.CompProperties_CompIncludedChildParts">
							<standardChildren>
								<li>BionicFoot</li>
								<li>PlasteelFemur</li>
								<li>PlasteelTibia</li>
							</standardChildren>
						</li>
					</value>
				</li>

        <!-- bionic hand -->

				<li Class="OrenoMSE.XpathPatches.PatchOperationAddToList">
					<xpath>/Defs/ThingDef[@ParentName="Bionic"][defName="BionicHand"]</xpath>
					<list>comps</list>
					<value>
						<li Class="OrenoMSE.CompProperties_CompIncludedChildParts">
							<standardChildren>
								<li>BionicFinger</li>
								<li>BionicFinger</li>
								<li>BionicFinger</li>
								<li>BionicFinger</li>
								<li>BionicFinger</li>
							</standardChildren>
						</li>
					</value>
				</li>

        <!-- bionic foot -->
				
				<li Class="OrenoMSE.XpathPatches.PatchOperationAddToList">
					<xpath>/Defs/ThingDef[@ParentName="Bionic"][defName="BionicFoot"]</xpath>
					<list>comps</list>
					<value>
						<li Class="OrenoMSE.CompProperties_CompIncludedChildParts">
							<standardChildren>
								<li>BionicToe</li>
								<li>BionicToe</li>
								<li>BionicToe</li>
								<li>BionicToe</li>
								<li>BionicToe</li>
							</standardChildren>
						</li>
					</value>
				</li>


        <!-- adding new parts -->

        <li Class="PatchOperationAdd"><xpath>/Defs</xpath><value>

          <!-- adv bionic shoulder -->
              
          <HediffDef ParentName="addedPartBionics">
            <defName>BionicShoulder</defName>
            <label>bionic shoulder</label>
            <labelNoun>a bionic shoulder</labelNoun>
            <description>An installed bionic arm.</description>
            <descriptionHyperlinks><ThingDef>BionicShoulder</ThingDef></descriptionHyperlinks>
            <addedPartProps>
              <solid>true</solid>
              <partEfficiency>1.25</partEfficiency>
            </addedPartProps>
            <spawnThingOnRemoved>BionicShoulder</spawnThingOnRemoved>
          </HediffDef>

          <RecipeDef ParentName="SurgeryBionic">
            <defName>InstallBionicShoulder</defName>
            <label>install bionic shoulder</label>
            <description>Installs a bionic shoulder.</description>
            <descriptionHyperlinks><ThingDef>BionicShoulder</ThingDef></descriptionHyperlinks>
            <jobString>Installing bionic shoulder.</jobString>
            <ingredients>
              <li>
                <filter>
                  <thingDefs>
                    <li>BionicShoulder</li>
                  </thingDefs>
                </filter>
                <count>1</count>
              </li>
            </ingredients>
            <fixedIngredientFilter>
              <thingDefs>
                <li>BionicShoulder</li>
              </thingDefs>
            </fixedIngredientFilter>
            <appliedOnFixedBodyParts>
              <li>Shoulder</li>
            </appliedOnFixedBodyParts>
            <addsHediff>BionicShoulder</addsHediff>
          </RecipeDef>
          
          <ThingDef ParentName="Bionic">    
            <defName>BionicShoulder</defName>
            <label>bionic shoulder</label>
            <description>One of the most sophisticated shoulder replacements.</description>
            <descriptionHyperlinks><RecipeDef>InstallBionicShoulder</RecipeDef></descriptionHyperlinks>
            <costList>
              <SimpleProstheticShoulder>1</SimpleProstheticShoulder>
              <Plasteel>45</Plasteel>
              <ComponentIndustrial>5</ComponentIndustrial>
            </costList>
            <statBases>
              <Mass>7</Mass>
            </statBases>
            <comps>
              <li Class="OrenoMSE.CompProperties_CompIncludedChildParts">
                <standardChildren>
                  <li>BionicArm</li>
                  <li>PlasteelClavicle</li>
                </standardChildren>
              </li>
            </comps>
          </ThingDef>

        </value></li>

			</operations>
		</match>
	</Operation>

</Patch>