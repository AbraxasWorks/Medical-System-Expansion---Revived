<?xml version="1.0" encoding="utf-8" ?>
<Patch>

	<Operation Class="PatchOperationFindMod">
		<mods>
			<li>Expanded Prosthetics and Organ Engineering</li>
		</mods>
		<match Class="PatchOperationSequence">
			<operations>

                <!-- Tab replacing -->

                <li Class="PatchOperationReplace">
                    <xpath>/Defs/ResearchProjectDef[tab="EPOE"]/tab</xpath>
                    <value>
                        <tab>MSE</tab>
                    </value>
                </li>

                <li Class="PatchOperationRemove">
                    <xpath>/Defs/ResearchTabDef[defName="EPOE"]</xpath>
                </li>

                <!-- extra dependecies -->

                <li Class="PatchOperationAdd">
                    <xpath>/Defs/ResearchProjectDef[defName="MSE_BrainImplants"]/prerequisites</xpath>
                    <value>
                        <li>BrainSurgery</li>
                    </value>
                </li>

                <!-- remove research -->
                <li Class="PatchOperationRemove">
                    <xpath>/Defs/ResearchProjectDef[defName="MSE_ProstheticOrgans" or defName="MSE_BionicOrgans"]</xpath>
                </li>
                <li Class="PatchOperationReplace">
                    <xpath>/Defs/ResearchProjectDef[defName="MSE_SpecialBionics"]/prerequisites/li[text()="MSE_BionicOrgans"]</xpath>
                    <value>
                        <li>SyntheticOrgans</li>
                    </value>
                </li>


                <!-- Research tab redistribuion -->

                <li Class="PatchOperationReplace">
                    <xpath>/Defs/ResearchProjectDef[defName="SurrogateOrgans" or defName="SyntheticOrgans" or defName="BionicWarfare"]/researchViewY</xpath>
                    <value>
                        <researchViewY>2</researchViewY>
                    </value>
                </li>
                <li Class="PatchOperationReplace">
                    <xpath>/Defs/ResearchProjectDef[defName="BrainSurgery"]/researchViewY</xpath>
                    <value>
                        <researchViewY>2.5</researchViewY>
                    </value>
                </li>

                <!-- special bionics (ribs) -->

                <li Class="PatchOperationAdd">
                    <xpath>/Defs/ThingDef[@ParentName="MSE_BodyPartBionicSpecial"][defName="BreathingSupportRib" or defName="RelaxationRib" or defName="ColdRegulatorRib" or defName="HeatRegulatorRib"]</xpath>
                    <value>                        
                        <recipeMaker Inherit="False">
                            <skillRequirements>
                                <Crafting>7</Crafting>
                            </skillRequirements>
                            <researchPrerequisite>RibReplacements</researchPrerequisite>
                        </recipeMaker>
                    </value>
                </li>
                
                <li Class="PatchOperationReplace">
                    <xpath>/Defs/ResearchProjectDef[defName="MSE_SpecialBionics"]/label</xpath>
                    <value>                        
                        <label>specialized organs</label>
                    </value>
                </li>




			</operations>
		</match>
	</Operation>

</Patch>